# Mac Agent Gateway (MAG) Configuration
# Copy this file to .env and customize

# Required: API key for authentication
# All requests must include X-API-Key header with this value
MAG_API_KEY=your-secret-api-key-here

# Host to bind to
# Default: 127.0.0.1 (localhost only - recommended for security)
# Set to 0.0.0.0 to allow external connections (use with caution)
MAG_HOST=127.0.0.1

# Port to listen on
# Default: 8123
MAG_PORT=8123

# Log level (DEBUG, INFO, WARNING, ERROR)
# Default: INFO
MAG_LOG_LEVEL=INFO

# ============================================================
# Logging Settings
# ============================================================

# Directory for log files (leave empty for stdout only)
# When set, logs are written to rotating files with secure permissions
# Default: (empty - stdout only)
# MAG_LOG_DIR=./logs

# Maximum size per log file before rotation (bytes)
# Default: 10485760 (10 MB)
MAG_LOG_MAX_BYTES=10485760

# Number of rotated log files to keep
# Default: 5
MAG_LOG_BACKUP_COUNT=5

# Enable access logging (HTTP request audit trail)
# Logs: timestamp, IP, method, path, status, duration
# Default: true
MAG_LOG_ACCESS=true

# ============================================================
# Messages (imsg) Settings
# ============================================================

# Path to imsg CLI binary
# Default: imsg (uses PATH)
MAG_IMSG_PATH=imsg

# Default region for phone number normalization
# Default: US
MAG_DEFAULT_REGION=US

# Path to contacts cache JSON file
# Default: ./data/contacts.json
MAG_CONTACTS_PATH=./data/contacts.json

# Allow sending to recipients not in contacts cache
# Default: true
MAG_ALLOW_UNKNOWN_RECIPIENTS=true

# PII (Personally Identifiable Information) filtering
# Options: "regex" (pattern-based masking), "" (disabled)
# Default: regex - filters SSNs, credit cards, passwords, etc. from message content
# Set to empty string to disable: MAG_PII_FILTER=
MAG_PII_FILTER=regex

# Send allowlist: comma-separated list of allowed recipients
# If set, only these phone numbers/emails can receive messages
# If empty (default), all recipients are allowed
# Example: +15551234567,+15559876543,user@example.com
MAG_MESSAGES_SEND_ALLOWLIST=

# File attachment allowed directories (comma-separated absolute paths)
# If set, only files in these directories can be attached to messages
# Security: Prevents path traversal attacks
# If empty (default), all readable files are allowed (less secure)
# Example: ~/Downloads,~/Pictures,~/Documents
MAG_ATTACHMENT_ALLOWED_DIRS=

# ============================================================
# Capability Settings (restrict what operations are allowed)
# ============================================================
# Use these to limit what agents can do via the API.
# All capabilities are enabled by default.

# Messages capabilities
MAG_MESSAGES_READ=true        # List threads, get message history
MAG_MESSAGES_SEARCH=true      # Search messages, extract links
MAG_MESSAGES_SEND=true        # Send messages, reply to threads
MAG_MESSAGES_WATCH=true       # Stream new messages (SSE)
MAG_MESSAGES_CONTACTS=true    # Manage contacts cache
MAG_MESSAGES_ATTACHMENTS=true # Download message attachments

# Reminders capabilities
MAG_REMINDERS_READ=true     # List reminders and lists
MAG_REMINDERS_WRITE=true    # Create, update, delete reminders
